<!DOCTYPE html>
<html>
<head>
    <title>3D GTA Launcher v1.0</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <hta:application 
        id="3D-GTA-Launcher" 
        applicationname="3D GTA Launcher" 
        border="dialog" 
        caption="yes" 
        maximizebutton="no"
        minimizebutton="yes" 
        sysmenu="yes" 
        windowstate="normal"
        icon="icons\gta.ico"
    >
    
    <style>
        body { background-color: #1e1e1e; color: #e0e0e0; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; overflow: hidden; }
        .container { display: flex; flex-direction: column; height: 90vh; }
        
        .header-row { display: block; text-align: center; position: relative; margin-bottom: 15px; height: 40px; }
        h1 { color: #00E676; margin: 0; font-size: 1.8em; text-shadow: 0 2px 4px rgba(0,0,0,0.5); display: inline-block;}
        
        .top-btn-group { position: absolute; right: 0; top: 5px; }
        .btn-header { background: #333; color: #ccc; border: 1px solid #444; padding: 6px 15px; cursor: pointer; border-radius: 4px; font-size: 0.85em; margin-left: 5px; }
        .btn-header:hover { background: #444; color: white; }
        .btn-toggle-edit.active { background: #FFC107; color: #1e1e1e; border-color: #FFC107; font-weight: bold; }

        .search-container { background: #2d2d2d; padding: 10px; border: 1px solid #333; border-radius: 8px; display: none; margin-bottom: 10px; border-left: 4px solid #FFC107; }
        .help-text { font-size: 0.8em; color: #aaa; margin-top: 8px; padding-top: 8px; border-top: 1px solid #444; }
        .highlight { color: #FFC107; font-weight: bold; }

        .layout-table { width: 100%; border-collapse: collapse; }
        .layout-td { vertical-align: middle; padding: 2px; }
        .search-label { white-space: nowrap; font-weight: bold; color: #FFC107; margin-right: 10px; }
        
        input[type="text"] { width: 100%; padding: 8px; border: 1px solid #444; background: #1a1a1a; color: white; font-family: monospace; font-size: 1em; }
        
        button { cursor: pointer; border: none; font-weight: bold; padding: 8px 15px; font-size: 0.8rem; border-radius: 4px; }
        .btn-scan { background-color: #2979FF; color: white; margin-left: 5px; }
        .btn-stop { background-color: #d32f2f; color: white; display: none; margin-left: 5px; }
        
        .toolbar { margin-top: 5px; margin-bottom: 5px; height: 30px; position: relative;}
        .options-area { position: absolute; left: 0; top: 5px; font-size: 0.8em; color: #aaa; }
        .btn-clear { position: absolute; right: 0; top: 0; background: transparent; color: #ff5252; border: 1px solid #ff5252; padding: 5px 10px; font-size: 0.7em; display: none; }
        .btn-clear:hover { background: #ff5252; color: white; }

        .results-area { flex-grow: 1; overflow-y: auto; border: 1px solid #333; background: #121212; padding: 10px; border-radius: 4px; }
        
        .game-table { width: 100%; border-collapse: collapse; margin-bottom: 8px; background: #252525; border-left: 4px solid #00E676; transition: background 0.2s; }
        .game-table:hover { background-color: #2d2d2d; }
        
        .game-td-icon { width: 50px; padding: 10px; text-align: center; vertical-align: middle; }
        .game-icon-img { width: 42px; height: 42px; object-fit: contain; border-radius: 4px; }
        .game-td-info { padding: 10px 5px; text-align: left; vertical-align: middle; }
        .game-td-actions { padding: 10px; text-align: right; width: 180px; white-space: nowrap; vertical-align: middle; }
        
        .game-title { font-size: 1.2em; font-weight: bold; color: #fff; display: block; margin-bottom: 4px; }
        .game-path { font-size: 0.75em; color: #888; font-family: monospace; display: block; }
        
        .btn-play { background-color: #00C853; color: white; padding: 10px 25px; font-size: 0.9em; text-transform: uppercase; letter-spacing: 1px; }
        .btn-play:hover { background-color: #00E676; box-shadow: 0 0 10px rgba(0,230,118,0.4); }

        .btn-icon { width: 30px; height: 30px; padding: 0; font-size: 14px; margin-left: 3px; }
        .btn-edit { background: #FFC107; color: #000; }
        .btn-edit:hover { background: #ffca28; }
        .btn-remove { background: #444; color: #aaa; }
        .btn-remove:hover { background: #f44336; color: white; }
        
        /* Bot√µes de Ordena√ß√£o */
        .btn-move { background: #555; color: white; font-size: 12px; }
        .btn-move:hover { background: #777; }

        .status-bar { margin-top: 10px; font-size: 0.85em; color: #666; text-align: right; border-top: 1px solid #333; padding-top: 5px;}
        
        /* Modais */
        .modal-overlay { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.85); z-index: 999; }
        .modal-center-table { width: 100%; height: 100%; border-collapse: collapse; }
        .modal-center-td { vertical-align: middle; text-align: center; }
        .modal-box { background: #2d2d2d; border: 1px solid #555; padding: 25px; width: 450px; box-shadow: 0 10px 30px rgba(0,0,0,1); border-radius: 8px; display: inline-block; text-align: left; }
        .modal-header { font-size: 1.4em; font-weight: bold; margin-bottom: 15px; border-bottom: 1px solid #444; padding-bottom: 10px; }
        .modal-text { margin-bottom: 20px; color: #ccc; line-height: 1.5; }
        .modal-input { width: 95%; padding: 10px; background: #1a1a1a; border: 1px solid #00E676; color: white; font-size: 1.1em; border-radius: 4px; margin-bottom: 20px; }
        .modal-footer { text-align: right; }
        .btn-modal { padding: 8px 20px; margin-left: 10px; }
        .btn-cancel { background: #444; color: white; }
        .btn-save { background: #00E676; color: white; }
        .btn-danger { background: #ff5252; color: white; }
        
        .repo-link { color: #2979FF; text-decoration: underline; cursor: pointer; }
        .border-edit { border-top: 4px solid #FFC107; }
        .text-edit { color: #FFC107; }
        .border-delete { border-top: 4px solid #ff5252; }
        .text-delete { color: #ff5252; }
        .border-info { border-top: 4px solid #2979FF; }
        .text-info { color: #2979FF; }
    </style>

    <script language="VBScript">
        Option Explicit
        Dim fso, shell, gameDict, iconDict, dataPath
        Dim scanTimer, tempFile, doneFile, currentEditPath
        Dim isEditMode
        
        ' Array para guardar a ordem dos jogos
        Dim gameOrderArray()
        Dim gameOrderCount
        
        Set fso = CreateObject("Scripting.FileSystemObject")
        Set shell = CreateObject("WScript.Shell")
        Set gameDict = CreateObject("Scripting.Dictionary")
        Set iconDict = CreateObject("Scripting.Dictionary")

        Sub Window_OnLoad
            Dim width, height, envProfile, tempFolder
            width = 850 : height = 700
            window.resizeTo width, height
            window.moveTo (screen.width - width) / 2, (screen.height - height) / 2
            
            dataPath = GetCurrentFolder() & "\launcher_data.json"
            Set tempFolder = fso.GetSpecialFolder(2)
            tempFile = tempFolder & "\launcher_scan_results.txt"
            doneFile = tempFolder & "\launcher_scan_done.flag"
            
            envProfile = shell.ExpandEnvironmentStrings("%USERPROFILE%")
            If envProfile <> "%USERPROFILE%" Then
                document.getElementById("pathInput").value = envProfile
            Else
                document.getElementById("pathInput").value = "C:\"
            End If

            Call LoadData()
            If gameDict.Count = 0 Then isEditMode = True
            Call UpdateInterfaceState()
        End Sub

        Function GetCurrentFolder()
            Dim path
            path = document.location.pathname
            If Left(path, 8) = "file:///" Then path = Mid(path, 9)
            path = Replace(path, "/", "\")
            path = Unescape(path)
            GetCurrentFolder = fso.GetParentFolderName(path)
        End Function

        ' --- GERENCIAMENTO DE DADOS ---
        Sub AddToOrder(path)
            Dim i
            For i = 0 To gameOrderCount - 1
                If LCase(gameOrderArray(i)) = LCase(path) Then Exit Sub
            Next
            ReDim Preserve gameOrderArray(gameOrderCount)
            gameOrderArray(gameOrderCount) = path
            gameOrderCount = gameOrderCount + 1
        End Sub

        Sub RemoveFromOrder(path)
            Dim i, newCount, tempArray()
            newCount = 0
            For i = 0 To gameOrderCount - 1
                If LCase(gameOrderArray(i)) <> LCase(path) Then
                    ReDim Preserve tempArray(newCount)
                    tempArray(newCount) = gameOrderArray(i)
                    newCount = newCount + 1
                End If
            Next
            gameOrderCount = newCount
            If newCount > 0 Then
                ReDim gameOrderArray(newCount - 1)
                For i = 0 To newCount - 1
                    gameOrderArray(i) = tempArray(i)
                Next
            Else
                Erase gameOrderArray
            End If
        End Sub

        Sub LoadData()
            gameDict.RemoveAll
            iconDict.RemoveAll
            gameOrderCount = 0
            Erase gameOrderArray
            
            document.getElementById("chkAutoClose").checked = True
            
            If fso.FileExists(dataPath) Then
                Dim file, content, lines, i, line, key, val, colonPos
                Set file = fso.OpenTextFile(dataPath, 1)
                If Not file.AtEndOfStream Then content = file.ReadAll
                file.Close
                
                lines = Split(content, vbCrLf)
                For i = 0 To UBound(lines)
                    line = Trim(lines(i))
                    If InStr(line, """autoClose""") > 0 Then
                        If InStr(LCase(line), """false""") > 0 Then document.getElementById("chkAutoClose").checked = False
                    End If
                    colonPos = InStr(line, """: """)
                    If colonPos > 0 And InStr(line, """autoClose""") = 0 Then
                        key = Left(line, colonPos - 1)
                        val = Mid(line, colonPos + 4)
                        key = Mid(key, 2) ' Remove aspas iniciais
                        val = Replace(val, """", "") ' Remove aspas do valor
                        If Right(val, 1) = "," Then val = Left(val, Len(val)-1)
                        key = Replace(key, "\\", "\") ' Corrige escape do JSON
                        
                        If fso.FileExists(key) Then
                            If Not gameDict.Exists(key) Then 
                                gameDict.Add key, val
                                Call AddToOrder(key)
                            End If
                        End If
                    End If
                Next
            End If
            Call SaveData() 
        End Sub

        Sub SaveData()
            Dim file, i, p, jsonStr, autoCloseVal, escPath
            If document.getElementById("chkAutoClose").checked Then autoCloseVal = "true" Else autoCloseVal = "false"
            Set file = fso.CreateTextFile(dataPath, True)
            file.WriteLine "{"
            file.WriteLine "  ""settings"": { ""autoClose"": """ & autoCloseVal & """ },"
            file.WriteLine "  ""games"": {"
            
            For i = 0 To gameOrderCount - 1
                p = gameOrderArray(i)
                If gameDict.Exists(p) Then
                    escPath = Replace(p, "\", "\\")
                    jsonStr = "    """ & escPath & """: """ & gameDict.Item(p) & """"
                    If i < gameOrderCount - 1 Then jsonStr = jsonStr & ","
                    file.WriteLine jsonStr
                End If
            Next
            
            file.WriteLine "  }"
            file.WriteLine "}"
            file.Close
        End Sub

        ' --- L√ìGICA DE UI ---
        Sub MoveGame(pathHTML, direction)
            Dim path, i, temp, idx
            path = CleanPath(pathHTML)
            idx = -1
            For i = 0 To gameOrderCount - 1
                If LCase(gameOrderArray(i)) = LCase(path) Then idx = i : Exit For
            Next
            
            If idx = -1 Then Exit Sub
            
            If direction = -1 And idx > 0 Then
                temp = gameOrderArray(idx) : gameOrderArray(idx) = gameOrderArray(idx - 1) : gameOrderArray(idx - 1) = temp
                Call SaveData() : Call RenderList()
            ElseIf direction = 1 And idx < gameOrderCount - 1 Then
                temp = gameOrderArray(idx) : gameOrderArray(idx) = gameOrderArray(idx + 1) : gameOrderArray(idx + 1) = temp
                Call SaveData() : Call RenderList()
            End If
        End Sub

        Sub ToggleEditMode()
            isEditMode = Not isEditMode
            Call UpdateInterfaceState()
        End Sub
        
        Sub UpdateInterfaceState()
            Dim searchBox, btnToggle, btnClear, playOptions
            Set searchBox = document.getElementById("searchBoxContainer")
            Set btnToggle = document.getElementById("btnEditMode")
            Set btnClear = document.getElementById("btnClear")
            Set playOptions = document.getElementById("playToolbar")
            
            If isEditMode Then
                searchBox.style.display = "block"
                btnClear.style.display = "block"
                playOptions.style.display = "none"
                btnToggle.innerText = "‚úî Done"
                btnToggle.className = "btn-header btn-toggle-edit active"
            Else
                searchBox.style.display = "none"
                btnClear.style.display = "none"
                playOptions.style.display = "block"
                btnToggle.innerText = "‚öô Edit"
                btnToggle.className = "btn-header btn-toggle-edit"
            End If
            Call RenderList()
        End Sub

        ' Otimiza√ß√£o: Cache de √çcones para evitar leitura de disco repetida
        Function GetGameIcon(exePath)
            If iconDict.Exists(exePath) Then
                GetGameIcon = iconDict.Item(exePath)
                Exit Function
            End If

            Dim folder, fileName, iconPath, appDir, defaultIcon
            folder = fso.GetParentFolderName(exePath)
            fileName = LCase(fso.GetFileName(exePath))
            appDir = GetCurrentFolder() & "\"
            
            If fso.FileExists(folder & "\icon.png") Then 
                iconPath = folder & "\icon.png"
            ElseIf fso.FileExists(folder & "\icon.ico") Then 
                iconPath = folder & "\icon.ico"
            Else
                Select Case fileName
                    Case "gta3.exe"    defaultIcon = "icons\iii.ico"
                    Case "gta-vc.exe"  defaultIcon = "icons\vc.ico"
                    Case "gta_sa.exe"  defaultIcon = "icons\sa.ico"
                End Select
                If fso.FileExists(appDir & defaultIcon) Then iconPath = appDir & defaultIcon Else iconPath = "joy.cpl"
            End If
            
            iconDict.Add exePath, iconPath
            GetGameIcon = iconPath
        End Function

        ' Otimiza√ß√£o: Uso de Array Join para renderizar HTML (muito mais r√°pido que concatena√ß√£o de strings)
        Sub RenderList()
            Dim i, p, niceName, safePath, safeExe, parentFolder, safeFullPath, iconSrc, rowHtml
            Dim htmlParts()
            
            If gameDict.Count = 0 Then
                document.getElementById("gameList").innerHTML = "<div style='text-align:center; padding:40px; color:#555;'>No games found in library.</div>"
                Exit Sub
            End If
            
            ReDim htmlParts(gameOrderCount - 1)
            
            For i = 0 To gameOrderCount - 1
                p = gameOrderArray(i)
                If gameDict.Exists(p) Then
                    niceName = gameDict.Item(p)
                    parentFolder = fso.GetParentFolderName(p)
                    safePath = Replace(parentFolder, "\", "\\")
                    safeExe = fso.GetFileName(p)
                    safeFullPath = Replace(p, "\", "\\")
                    iconSrc = GetGameIcon(p)
                    
                    rowHtml = "<table class='game-table'><tr>" & _
                              "<td class='game-td-icon'>"
                    
                    If iconSrc <> "joy.cpl" Then
                        rowHtml = rowHtml & "<img src='" & iconSrc & "' class='game-icon-img' onerror='this.style.display=""none""'>"
                    Else
                        rowHtml = rowHtml & "<span style='font-size:24px;'>üéÆ</span>"
                    End If
                    
                    rowHtml = rowHtml & "</td><td class='game-td-info'>" & _
                              "<span class='game-title'>" & niceName & "</span>" & _
                              "<span class='game-path' title='" & p & "'>" & p & "</span></td>" & _
                              "<td class='game-td-actions'>"
                    
                    If isEditMode Then
                        rowHtml = rowHtml & "<button class='btn-icon btn-move' title='Move Up' onclick='MoveGame """ & safeFullPath & """, -1'>‚¨Ü</button>" & _
                                            "<button class='btn-icon btn-move' title='Move Down' onclick='MoveGame """ & safeFullPath & """, 1'>‚¨á</button>" & _
                                            "<button class='btn-icon btn-edit' title='Rename' onclick='UI_OpenRename """ & safeFullPath & """'>üñäÔ∏è</button>" & _
                                            "<button class='btn-icon btn-remove' title='Remove' onclick='RemoveGame """ & safeFullPath & """'>‚ùå</button>"
                    Else
                        rowHtml = rowHtml & "<button class='btn-play' onclick='LaunchGame """ & safePath & """, """ & safeExe & """'>PLAY</button>"
                    End If
                    
                    rowHtml = rowHtml & "</td></tr></table>"
                    htmlParts(i) = rowHtml
                End If
            Next
            document.getElementById("gameList").innerHTML = Join(htmlParts, "")
        End Sub

        ' --- SCANNING ---
        Sub StartScan()
            Dim pathStr, cmd
            pathStr = Trim(document.getElementById("pathInput").value)
            If Right(pathStr, 1) = "\" Then pathStr = Left(pathStr, Len(pathStr) - 1)
            If Not fso.FolderExists(pathStr) Then
                MsgBox "Folder not found!", 48, "Error"
                Exit Sub
            End If
            ToggleLoading(True)
            document.getElementById("statusText").innerHTML = "SCANNING..."
            On Error Resume Next
            fso.DeleteFile tempFile : fso.DeleteFile doneFile
            On Error Goto 0
            cmd = "cmd /c ""dir /s /b /a:-d """ & pathStr & "\gta*.exe"" > """ & tempFile & """ & echo DONE > """ & doneFile & """"""
            shell.Run cmd, 0, False
            scanTimer = window.setInterval("CheckScanFile", 100)
        End Sub

        Sub CheckScanFile()
            If fso.FileExists(doneFile) Then
                window.clearInterval(scanTimer)
                Call ProcessScanResults()
            End If
        End Sub

        Sub StopScan()
            window.clearInterval(scanTimer)
            ToggleLoading(False)
            document.getElementById("statusText").innerHTML = "Cancelled."
        End Sub

        Sub ProcessScanResults()
            Dim file, content, lines, i, line, fileName, fullPath, addedCount, newOrder(), newCount
            addedCount = 0 : newCount = 0
            
            If fso.FileExists(tempFile) Then
                If fso.GetFile(tempFile).Size > 0 Then
                    Set file = fso.OpenTextFile(tempFile, 1)
                    content = file.ReadAll()
                    file.Close
                    lines = Split(content, vbCrLf)
                    For i = 0 To UBound(lines)
                        line = Trim(lines(i))
                        If line <> "" Then
                            fullPath = line
                            fileName = LCase(fso.GetFileName(fullPath))
                            If fileName = "gta3.exe" OR fileName = "gta-vc.exe" OR fileName = "gta_sa.exe" Then
                                If Not gameDict.Exists(fullPath) Then
                                    gameDict.Add fullPath, GetDefaultGameName(fullPath)
                                    Call AddToOrder(fullPath)
                                    addedCount = addedCount + 1
                                End If
                            End If
                        End If
                    Next
                End If
                On Error Resume Next
                fso.DeleteFile tempFile : fso.DeleteFile doneFile
            End If

            ' Limpeza de inv√°lidos
            For i = 0 To gameOrderCount - 1
                If fso.FileExists(gameOrderArray(i)) Then
                    ReDim Preserve newOrder(newCount)
                    newOrder(newCount) = gameOrderArray(i)
                    newCount = newCount + 1
                Else
                    If gameDict.Exists(gameOrderArray(i)) Then gameDict.Remove(gameOrderArray(i))
                End If
            Next
            
            gameOrderCount = newCount
            If newCount > 0 Then
                ReDim gameOrderArray(newCount - 1)
                For i = 0 To newCount - 1
                    gameOrderArray(i) = newOrder(i)
                Next
            Else
                Erase gameOrderArray
            End If

            Call SaveData() : Call RenderList() : ToggleLoading(False)
            
            Dim msg : msg = "Ready."
            If addedCount > 0 Then msg = "+" & addedCount & " new. "
            document.getElementById("statusText").innerHTML = msg
        End Sub

        Sub ToggleLoading(isLoading)
            Dim btnScan, btnStop
            Set btnScan = document.getElementById("btnScan")
            Set btnStop = document.getElementById("btnStop")
            If isLoading Then
                btnScan.style.display = "none" : btnStop.style.display = "inline" : document.body.style.cursor = "wait"
            Else
                btnScan.style.display = "inline" : btnStop.style.display = "none" : document.body.style.cursor = "default"
            End If
        End Sub

        Function GetDefaultGameName(path)
            Dim n : n = LCase(fso.GetFileName(path))
            If n = "gta3.exe" Then GetDefaultGameName = "Grand Theft Auto III"
            If n = "gta-vc.exe" Then GetDefaultGameName = "GTA: Vice City"
            If n = "gta_sa.exe" Then GetDefaultGameName = "GTA: San Andreas"
            If GetDefaultGameName = "" Then GetDefaultGameName = "Unknown GTA" 
        End Function

        Function CleanPath(p)
            CleanPath = Replace(p, "\\", "\")
        End Function

        Sub LaunchGame(folder, exeName)
            On Error Resume Next
            Dim realFolder : realFolder = CleanPath(folder)
            shell.CurrentDirectory = realFolder
            If Err.Number <> 0 Then
                MsgBox "Error: Folder not found.", 16, "Error"
                If MsgBox("Remove from list?", 36, "Clean") = 6 Then RemoveGame CleanPath(folder) & "\" & exeName
                Exit Sub
            End If
            shell.Run Chr(34) & exeName & Chr(34), 1, False
            If document.getElementById("chkAutoClose").checked Then window.close()
        End Sub

        Sub RemoveGame(pathHTML)
            Dim realPath : realPath = CleanPath(pathHTML)
            If gameDict.Exists(realPath) Then
                gameDict.Remove(realPath)
                iconDict.Remove(realPath) ' Remove do cache tamb√©m
                Call RemoveFromOrder(realPath)
                Call SaveData()
                Call RenderList()
            End If
        End Sub
        
        Sub UI_OpenRename(pathHTML)
            Dim realPath : realPath = CleanPath(pathHTML)
            If gameDict.Exists(realPath) Then
                currentEditPath = realPath
                document.getElementById("inputRename").value = gameDict.Item(realPath)
                document.getElementById("modalRename").style.display = "block"
                document.getElementById("inputRename").focus()
            End If
        End Sub

        Sub UI_SaveRename()
            Dim newName : newName = document.getElementById("inputRename").value
            newName = Replace(newName, """", "'") 
            If newName <> "" And currentEditPath <> "" Then
                If gameDict.Exists(currentEditPath) Then
                    gameDict.Item(currentEditPath) = newName
                    Call SaveData()
                    Call RenderList()
                End If
                UI_CloseModals()
            Else
                MsgBox "The name cannot be empty.", 48, "Warning"
            End If
        End Sub

        Sub UI_OpenClearConfirm()
            document.getElementById("modalClear").style.display = "block"
        End Sub
        
        Sub UI_OpenAbout()
            document.getElementById("modalAbout").style.display = "block"
        End Sub

        Sub UI_ConfirmClear()
            gameDict.RemoveAll
            iconDict.RemoveAll
            Erase gameOrderArray
            gameOrderCount = 0
            Call SaveData()
            Call RenderList()
            If Not isEditMode Then ToggleEditMode()
            UI_CloseModals()
            document.getElementById("statusText").innerHTML = "Library cleared."
        End Sub

        Sub UI_CloseModals()
            document.getElementById("modalRename").style.display = "none"
            document.getElementById("modalClear").style.display = "none"
            document.getElementById("modalAbout").style.display = "none"
            currentEditPath = ""
        End Sub
        
        Sub OpenRepo()
            shell.Run "https://github.com/KaioHSG/3d-gta-launcher ", 1, False
        End Sub
    </script>
</head>
<body>
    <div class="container">
        <div class="header-row">
            <h1>3D GTA Launcher  <small style="font-size:0.4em; color:#666;">v1.0</small></h1>
            <div class="top-btn-group">
                <button class="btn-header" onclick="UI_OpenAbout()" title="About">‚ùì</button>
                <button id="btnEditMode" class="btn-header btn-toggle-edit" onclick="ToggleEditMode()">‚öô Edit</button>
            </div>
        </div>

        <div id="searchBoxContainer" class="search-container">
            <table class="layout-table"><tr>
                <td class="layout-td" style="width:1%;">
                    <label class="search-label">Scan Folder:</label>
                </td>
                <td class="layout-td">
                    <input type="text" id="pathInput" title="Path to search for games">
                </td>
                <td class="layout-td" style="width:1%; white-space:nowrap;">
                    <button id="btnScan" class="btn-scan" onclick="StartScan()">Scan</button>
                    <button id="btnStop" class="btn-stop" onclick="StopScan()">Stop</button>
                </td>
            </tr></table>
            <div class="help-text">
                Place <span class="highlight">icon.png</span> in the game folder to customize.
            </div>
        </div>
        
        <div class="toolbar">
            <div id="playToolbar" class="options-area">
                <input type="checkbox" id="chkAutoClose" checked onclick="SaveData()"> 
                <label for="chkAutoClose" style="cursor:pointer;">Close on game launch</label>
            </div>
            <button id="btnClear" class="btn-clear" onclick="UI_OpenClearConfirm()">Clear All</button>
        </div>

        <div id="gameList" class="results-area"></div>

        <div class="status-bar">
            <span id="statusText">Ready.</span>
        </div>
    </div>

    <!-- Modais -->
    <div id="modalRename" class="modal-overlay">
        <table class="modal-center-table"><tr><td class="modal-center-td">
            <div class="modal-box border-edit">
                <div class="modal-header text-edit">Rename Game</div>
                <div class="modal-text">New name:</div>
                <input type="text" id="inputRename" class="modal-input" maxlength="50">
                <div class="modal-footer">
                    <button class="btn-modal btn-cancel" onclick="UI_CloseModals()">Cancel</button>
                    <button class="btn-modal btn-save" onclick="UI_SaveRename()">Save</button>
                </div>
            </div>
        </td></tr></table>
    </div>

    <div id="modalClear" class="modal-overlay">
        <table class="modal-center-table"><tr><td class="modal-center-td">
            <div class="modal-box border-delete">
                <div class="modal-header text-delete">Delete All?</div>
                <div class="modal-text">Do you want to delete the entire library?</div>
                <div class="modal-footer">
                    <button class="btn-modal btn-cancel" onclick="UI_CloseModals()">Cancel</button>
                    <button class="btn-modal btn-danger" onclick="UI_ConfirmClear()">Clear All</button>
                </div>
            </div>
        </td></tr></table>
    </div>
    
    <div id="modalAbout" class="modal-overlay">
        <table class="modal-center-table"><tr><td class="modal-center-td">
            <div class="modal-box border-info">
                <div class="modal-header text-info">About</div>
                <div class="modal-text" style="text-align:center;">
                    <strong style="font-size:1.2em; color:white;">3D GTA Launcher </strong><br>
                    <span style="color:#aaa;">Version 1.0</span><br><br>
                    A simple launcher to organize your classic games.<br>
                    <span class="repo-link" onclick="OpenRepo()">Visit GitHub Repository</span>
                </div>
                <div class="modal-footer" style="text-align:center;">
                    <button class="btn-modal btn-cancel" onclick="UI_CloseModals()">Close</button>
                </div>
            </div>
        </td></tr></table>
    </div>
</body>
</html>